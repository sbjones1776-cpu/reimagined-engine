import{a2 as I,B as C,y as f,g as U,x as e,E as w,o,u as c,w as B,G as j,m as P,k as $,a as E,ab as V,r as h,v as b,U as W,R as H,e as y,s as Y,T as K,ac as J,I as M,t as Q,Y as Z,ad as ee,ae as se}from"./index-C_0kN0Kc.js";import{e as te}from"./zap-BUGd4PS--D5Rx8Je6.js";import{o as ae}from"./flame-Z4NDYWf0-CPLPmaZ3.js";import{i as D}from"./trending-up-DOxCo9I6-CjyZKRpy.js";import{s as re,h as le,k as ne,f as ie,a as oe,b as ce,l as de,L as T}from"./LineChart-Boznw0oC-BjVvaeYB.js";import{o as v}from"./target-1p2ICMDN-CvDzxGjB.js";import{c as me}from"./gift-gU3fLUyU-xa62twJ2.js";function xe(s,d){const a=Y(),n=a.getQueryCache();return K.useSyncExternalStore(K.useCallback(i=>n.subscribe(J.batchCalls(i)),[n]),()=>a.isFetching(s),()=>a.isFetching(s))}function he({progress:s}){const d=[{id:"first_game",name:"First Steps",description:"Complete your first game",icon:j,color:"from-blue-400 to-blue-600",unlocked:s.length>=1},{id:"ten_games",name:"Practice Makes Perfect",description:"Play 10 games",icon:te,color:"from-yellow-400 to-orange-600",unlocked:s.length>=10},{id:"perfect_score",name:"Perfect Score",description:"Get 100% on any level",icon:w,color:"from-purple-400 to-pink-600",unlocked:s.some(a=>a.correct_answers/a.total_questions===1)},{id:"three_stars",name:"Star Collector",description:"Earn 3 stars in a game",icon:j,color:"from-yellow-400 to-yellow-600",unlocked:s.some(a=>a.stars_earned===3)},{id:"speed_demon",name:"Speed Demon",description:"Complete a game in under 60 seconds",icon:ae,color:"from-red-400 to-orange-600",unlocked:s.some(a=>a.time_taken<60)},{id:"master",name:"Math Master",description:"Complete all operations on hard",icon:M,color:"from-indigo-400 to-purple-600",unlocked:["addition","subtraction","multiplication","division"].every(a=>s.some(n=>n.operation===a&&n.level==="hard"&&n.stars_earned>=2))}];return e.jsxs(o,{className:"mb-8",children:[e.jsx(h,{children:e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-6 h-6 text-purple-500"}),"Achievements"]})}),e.jsx(c,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:d.map(a=>{const n=a.icon;return e.jsxs("div",{className:`text-center p-4 rounded-xl border-2 transition-all ${a.unlocked?"bg-gradient-to-br "+a.color+" text-white border-transparent shadow-lg":"bg-gray-100 border-gray-200 opacity-50"}`,children:[e.jsx(n,{className:`w-12 h-12 mx-auto mb-2 ${a.unlocked?"":"text-gray-400"}`}),e.jsx("h4",{className:"font-bold text-sm mb-1",children:a.name}),e.jsx("p",{className:`text-xs ${a.unlocked?"text-white/90":"text-gray-500"}`,children:a.description})]},a.id)})})})]})}function pe({progress:s}){const d=s.slice(0,10).reverse().map((a,n)=>({name:`Game ${n+1}`,score:a.score,accuracy:Math.round(a.correct_answers/a.total_questions*100)}));return e.jsxs(o,{className:"mb-8",children:[e.jsx(h,{children:e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-6 h-6 text-green-500"}),"Performance Over Time"]})}),e.jsx(c,{children:d.length>0?e.jsx(re,{width:"100%",height:300,children:e.jsxs(le,{data:d,children:[e.jsx(ne,{strokeDasharray:"3 3"}),e.jsx(ie,{dataKey:"name"}),e.jsx(oe,{}),e.jsx(ce,{}),e.jsx(de,{}),e.jsx(T,{type:"monotone",dataKey:"score",stroke:"#8b5cf6",strokeWidth:3}),e.jsx(T,{type:"monotone",dataKey:"accuracy",stroke:"#10b981",strokeWidth:3})]})}):e.jsx("div",{className:"text-center py-12 text-gray-500",children:"Play some games to see your performance chart!"})})]})}function ge({progress:s}){const d=s.slice(0,10),a={addition:"âž•",subtraction:"âž–",multiplication:"âœ–ï¸",division:"âž—"},n={easy:"bg-green-500",medium:"bg-yellow-500",hard:"bg-red-500"};return e.jsxs(o,{children:[e.jsx(h,{children:e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(y,{className:"w-6 h-6 text-blue-500"}),"Recent Games"]})}),e.jsx(c,{children:e.jsx("div",{className:"space-y-3",children:d.map((i,l)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl border border-purple-100 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-3xl",children:a[i.operation]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-bold capitalize",children:i.operation}),e.jsx(H,{className:n[i.level]+" text-white",children:i.level})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(v,{className:"w-4 h-4"}),i.correct_answers,"/",i.total_questions]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(y,{className:"w-4 h-4"}),i.time_taken,"s"]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"flex gap-1 mb-1",children:[1,2,3].map(g=>e.jsx(j,{className:`w-5 h-5 ${g<=i.stars_earned?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},g))}),e.jsx("div",{className:"text-sm text-gray-500",children:Q(new Date(i.created_date),"MMM d, h:mm a")})]})]},l))})})]})}function ve(){const{user:s}=I(),[d,a]=C.useState([]),{data:n=[],isLoading:i}=f({queryKey:["gameProgress",s==null?void 0:s.email],queryFn:async()=>s!=null&&s.email?await Z(s.email):[],initialData:[],enabled:!!(s!=null&&s.email),onSuccess:t=>{d.length||a(t)}});C.useEffect(()=>{if(!(s!=null&&s.email))return;const t=U(s.email,r=>{a(r)});return()=>t()},[s==null?void 0:s.email]);const l=d.length?d:n,{data:g=[]}=f({queryKey:["userDailyChallenges",s==null?void 0:s.email],queryFn:async()=>s!=null&&s.email?await ee(s.email):[],initialData:[],enabled:!!(s!=null&&s.email)}),{data:u=[]}=f({queryKey:["tutorSessions",s==null?void 0:s.email],queryFn:async()=>s!=null&&s.email?await se(s.email):[],initialData:[],enabled:!!(s!=null&&s.email)}),k=()=>l.reduce((t,r)=>t+(r.stars_earned||0),0),F=()=>g.reduce((t,r)=>t+(r.bonus_stars||0),0),G=()=>l.reduce((t,r)=>t+(r.score||0),0),O=()=>{if(l.length===0)return 0;const t=l.reduce((r,m)=>r+m.correct_answers/m.total_questions*100,0);return Math.round(t/l.length)},R=()=>l.reduce((t,r)=>t+(r.time_taken||0),0),_=()=>l.length,N=k()+F(),L=N-((s==null?void 0:s.stars_spent)||0),S=(()=>{const t=_(),r=l.some(p=>p.stars_earned===3),m=l.some(p=>p.correct_answers/p.total_questions===1),X=l.some(p=>p.level==="hard"&&p.stars_earned>=2),z=g.length,x=[];return t>=5&&x.push({name:"Curly Hair",emoji:"ðŸ¦±"}),t>=7&&x.push({name:"Hat",emoji:"ðŸŽ©"}),t>=10&&x.push({name:"Sporty Outfit",emoji:"âš½"}),N>=10&&x.push({name:"Spiky Hair",emoji:"âš¡"}),r&&x.push({name:"Cool Eyes",emoji:"ðŸ˜Ž"}),m&&x.push({name:"Heart Eyes & Pirate Outfit",emoji:"ðŸ˜ðŸ´â€â˜ ï¸"}),X&&x.push({name:"Purple Hair, Superhero Outfit & Cape",emoji:"ðŸ¦¸"}),z>=7&&x.push({name:"Artist Outfit",emoji:"ðŸŽ¨"}),x.slice(0,3)})(),A=xe({queryKey:["gameProgress",s==null?void 0:s.email]})>0,q=(()=>{const t={};return u.forEach(r=>{const m=`${r.operation}-${r.level}`;t[m]||(t[m]={operation:r.operation,level:r.level,count:0}),t[m].count++}),Object.values(t).sort((r,m)=>m.count-r.count).slice(0,3)})();return i?e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-16 h-16 border-4 border-purple-500 border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Loading your progress..."})]})}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[A&&e.jsx("div",{className:"fixed top-20 right-4 z-40",children:e.jsxs("div",{className:"flex items-center gap-2 bg-white/90 backdrop-blur px-3 py-2 rounded-full shadow border",children:[e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-purple-500 border-t-transparent rounded-full"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Updatingâ€¦"})]})}),e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("div",{className:"inline-block mb-6",children:e.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full flex items-center justify-center shadow-2xl",children:e.jsx(w,{className:"w-12 h-12 text-white"})})}),e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-4 bg-gradient-to-r from-purple-600 via-pink-600 to-blue-600 bg-clip-text text-transparent",children:"Your Progress"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Keep up the great work! ðŸŽ‰"})]}),l.length===0?e.jsx(o,{className:"text-center py-12",children:e.jsxs(c,{children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(B,{size:"lg",variant:"circle"})}),e.jsx("h3",{className:"text-2xl font-bold mb-2",children:"No games played yet!"}),e.jsx("p",{className:"text-gray-600",children:"Start playing to see your progress here."})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-8",children:[e.jsx(o,{className:"md:col-span-2 border-4 border-yellow-300 shadow-xl bg-gradient-to-r from-yellow-50 to-orange-50",children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full flex items-center justify-center shadow-lg",children:e.jsx(j,{className:"w-8 h-8 text-white fill-white"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-3xl font-bold text-gray-800",children:[L," Stars Available"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[N," total earned â€¢ ",(s==null?void 0:s.stars_spent)||0," spent"]})]})]}),e.jsx(P,{to:$("Shop"),children:e.jsxs(E,{className:"h-12 bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600",children:[e.jsx(V,{className:"w-5 h-5 mr-2"}),"Visit Shop"]})})]})})}),S.length>0&&e.jsx(o,{className:"border-4 border-green-300 shadow-xl bg-gradient-to-r from-green-50 to-emerald-50",children:e.jsxs(c,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(me,{className:"w-6 h-6 text-green-600"}),e.jsx("h3",{className:"font-bold text-lg text-green-800",children:"New Rewards!"})]}),e.jsx("div",{className:"space-y-2 mb-3",children:S.map((t,r)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-xl",children:t.emoji}),e.jsx("span",{className:"font-medium",children:t.name})]},r))}),e.jsx(P,{to:$("Shop"),children:e.jsx(E,{variant:"outline",className:"w-full border-green-400 text-green-700 hover:bg-green-100",children:"Claim Rewards"})})]})})]}),u.length>0&&e.jsxs(o,{className:"mb-8 border-4 border-blue-300 shadow-xl bg-gradient-to-r from-blue-50 to-purple-50",children:[e.jsx(h,{className:"bg-gradient-to-r from-blue-100 to-purple-100 p-6 rounded-t-xl",children:e.jsxs(b,{className:"flex items-center gap-2 text-xl font-bold text-blue-800",children:[e.jsx(W,{className:"w-7 h-7 text-blue-600"}),"AI Tutor Learning Insights"]})}),e.jsxs(c,{className:"p-6",children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-xl text-center border-2 border-blue-200 shadow-sm",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:u.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Tutoring Sessions"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl text-center border-2 border-purple-200 shadow-sm",children:[e.jsx("div",{className:"text-3xl font-bold text-purple-600",children:u.filter(t=>t.hint_requested).length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Hints Received"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl text-center border-2 border-green-200 shadow-sm",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:u.filter(t=>t.explanation_viewed).length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Explanations Viewed"})]})]}),q.length>0&&e.jsxs("div",{className:"bg-white p-4 rounded-xl border-2 border-orange-200 shadow-sm",children:[e.jsxs("h4",{className:"font-bold mb-3 flex items-center gap-2 text-lg text-orange-700",children:[e.jsx(v,{className:"w-5 h-5 text-orange-600"}),"Practice These Topics"]}),e.jsx("div",{className:"space-y-2",children:q.map((t,r)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"capitalize font-medium text-gray-700",children:[t.operation," (",t.level,")"]}),e.jsxs(H,{variant:"outline",className:"bg-orange-50 text-orange-600 border-orange-200",children:[t.count," times needed help"]})]},r))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-8",children:[e.jsxs(o,{className:"bg-gradient-to-br from-yellow-400 to-orange-500 text-white border-0",children:[e.jsx(h,{className:"pb-2",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsx(j,{className:"w-8 h-8 fill-white"})})}),e.jsxs(c,{children:[e.jsx("div",{className:"text-3xl font-bold mb-1",children:k()}),e.jsx("p",{className:"text-sm text-white/90",children:"Game Stars"})]})]}),e.jsxs(o,{className:"bg-gradient-to-br from-purple-500 to-pink-500 text-white border-0",children:[e.jsx(h,{className:"pb-2",children:e.jsx(w,{className:"w-8 h-8"})}),e.jsxs(c,{children:[e.jsx("div",{className:"text-3xl font-bold mb-1",children:G()}),e.jsx("p",{className:"text-sm text-white/90",children:"Total Score"})]})]}),e.jsxs(o,{className:"bg-gradient-to-br from-green-500 to-emerald-500 text-white border-0",children:[e.jsx(h,{className:"pb-2",children:e.jsx(v,{className:"w-8 h-8"})}),e.jsxs(c,{children:[e.jsxs("div",{className:"text-3xl font-bold mb-1",children:[O(),"%"]}),e.jsx("p",{className:"text-sm text-white/90",children:"Accuracy"})]})]}),e.jsxs(o,{className:"bg-gradient-to-br from-blue-500 to-cyan-500 text-white border-0",children:[e.jsx(h,{className:"pb-2",children:e.jsx(y,{className:"w-8 h-8"})}),e.jsxs(c,{children:[e.jsxs("div",{className:"text-3xl font-bold mb-1",children:[Math.floor(R()/60),"m"]}),e.jsx("p",{className:"text-sm text-white/90",children:"Time Played"})]})]}),e.jsxs(o,{className:"bg-gradient-to-br from-indigo-500 to-purple-500 text-white border-0",children:[e.jsx(h,{className:"pb-2",children:e.jsx(D,{className:"w-8 h-8"})}),e.jsxs(c,{children:[e.jsx("div",{className:"text-3xl font-bold mb-1",children:_()}),e.jsx("p",{className:"text-sm text-white/90",children:"Games Played"})]})]})]}),e.jsx(he,{progress:l}),e.jsx(pe,{progress:l}),e.jsx(ge,{progress:l})]})]})}export{ve as default};
