import{C,x as S}from"./index-BXLScRZ5.js";let r={},y=null;function k(b="en-US",v=!0,g={}){const{useSavedPrefs:i=!0,langPrefOverride:m,voiceNameOverride:h}=g;try{const e=localStorage.getItem("tts.cacheBuster");i&&e&&e!==y&&(r={},y=e)}catch{}const o=window.speechSynthesis.getVoices();let l="en",c="Emma";try{if(i){l=localStorage.getItem("tts.lang")==="es"?"es":"en";const e=localStorage.getItem("tts.voiceName");c=e&&e.toLowerCase()!=="david"?e:"Emma"}else l=m==="es"?"es":"en",c=h||"Emma"}catch{}const n=`${i?"saved":"override"}:${l}:${c}`;if(r[n])return r[n];if(o&&o.length){let e=o.filter(s=>(s.lang||"").toLowerCase().startsWith(l));const d=c.toLowerCase();let a=e.find(s=>s.name.toLowerCase().includes(d));if(a)return r[n]=a,a;const t=["emma","female","woman","girl","zira","jenny","olivia","sonia","ana","isabella","sara","sofia","monica","paulina"];if(a=e.find(s=>t.some(p=>s.name.toLowerCase().includes(p))),a)return r[n]=a,a;const u=["david","male","man","boy","mark","james","richard","thomas","daniel","george"],f=e.filter(s=>!u.some(p=>s.name.toLowerCase().includes(p)));if(f.length>0)return r[n]=f[0],f[0];const w=o.filter(s=>t.some(p=>s.name.toLowerCase().includes(p)));if(w.length>0)return r[n]=w[0],w[0]}return o.find(e=>e.default)||o[0]}function L({text:b,lang:v="en-US",style:g="button",label:i="ðŸ”Š Listen",rate:m=.9,useSavedPrefs:h=!0,overrideLangPref:o,overrideVoiceName:l}){const c=C.useRef(null),n=()=>{if(!("speechSynthesis"in window)){alert("Text-to-speech is not supported in this browser.");return}window.speechSynthesis.cancel();const a=window.speechSynthesis.getVoices();if(!a||a.length===0){window.speechSynthesis.getVoices(),setTimeout(()=>n(),100);return}const t=new window.SpeechSynthesisUtterance(b);try{const u=h?localStorage.getItem("tts.lang")==="es"?"es":"en":o==="es"?"es":"en";t.lang=u==="es"?"es-ES":"en-US"}catch{t.lang=v}try{const u=h?parseFloat(localStorage.getItem("tts.rate")):m;t.pitch=1,t.rate=Number.isNaN(u)?m:Math.min(2,Math.max(.1,u))}catch{t.pitch=1,t.rate=Math.min(2,Math.max(.1,m))}t.voice=k(t.lang,!0,{useSavedPrefs:h,langPrefOverride:o,voiceNameOverride:l||"Emma"}),c.current=t,window.speechSynthesis.speak(t)},e=()=>{window.speechSynthesis.cancel()};let d;return g==="badge"?d=S.jsx("span",{onClick:n,onDoubleClick:e,className:"inline-block px-2 py-1 bg-purple-100 text-purple-700 rounded cursor-pointer select-none",title:"Click to read aloud, double-click to stop",children:i}):g==="icon"?d=S.jsx("span",{onClick:n,onDoubleClick:e,className:"cursor-pointer",title:"Click to read aloud, double-click to stop",role:"img","aria-label":"Read aloud",children:"ðŸ”Š"}):d=S.jsx("button",{type:"button",onClick:n,onDoubleClick:e,"aria-label":"Read aloud",className:"px-3 py-2 rounded bg-purple-100 hover:bg-purple-200 text-purple-700 font-semibold",children:i}),d}export{L};
