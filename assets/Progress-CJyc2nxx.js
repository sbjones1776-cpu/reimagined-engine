import{z as I,r as P,a4 as z,x as u,T as y,K as T,j as e,C as c,M as h,N as b,d as o,e as w,B as F,f as Q,a1 as Y,R as q,u as N,D as V,H as W,L as G,g as M,h as A,a5 as X,E as Z,O as J,a6 as ee,a7 as se}from"./index-52tutDqx.js";import{Z as te}from"./zap-BUGd4PS-.js";import{F as ae}from"./flame-Z4NDYWf0.js";import{T as D}from"./trending-up-DOxCo9I6.js";import{R as re,L as le,C as ne,X as ie,Y as ce,T as oe,a as de,b as E}from"./LineChart-Boznw0oC.js";import{T as v}from"./target-1p2ICMDN.js";import{G as me}from"./gift-gU3fLUyU.js";function xe(s,m){const a=I(),l=a.getQueryCache();return P.useSyncExternalStore(P.useCallback(i=>l.subscribe(z.batchCalls(i)),[l]),()=>a.isFetching(s),()=>a.isFetching(s))}function he({progress:s}){const m=[{id:"first_game",name:"First Steps",description:"Complete your first game",icon:u,color:"from-blue-400 to-blue-600",unlocked:s.length>=1},{id:"ten_games",name:"Practice Makes Perfect",description:"Play 10 games",icon:te,color:"from-yellow-400 to-orange-600",unlocked:s.length>=10},{id:"perfect_score",name:"Perfect Score",description:"Get 100% on any level",icon:y,color:"from-purple-400 to-pink-600",unlocked:s.some(a=>a.correct_answers/a.total_questions===1)},{id:"three_stars",name:"Star Collector",description:"Earn 3 stars in a game",icon:u,color:"from-yellow-400 to-yellow-600",unlocked:s.some(a=>a.stars_earned===3)},{id:"speed_demon",name:"Speed Demon",description:"Complete a game in under 60 seconds",icon:ae,color:"from-red-400 to-orange-600",unlocked:s.some(a=>a.time_taken<60)},{id:"master",name:"Math Master",description:"Complete all operations on hard",icon:T,color:"from-indigo-400 to-purple-600",unlocked:["addition","subtraction","multiplication","division"].every(a=>s.some(l=>l.operation===a&&l.level==="hard"&&l.stars_earned>=2))}];return e.jsxs(c,{className:"mb-8",children:[e.jsx(h,{children:e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-6 h-6 text-purple-500"}),"Achievements"]})}),e.jsx(o,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:m.map(a=>{const l=a.icon;return e.jsxs("div",{className:`text-center p-4 rounded-xl border-2 transition-all ${a.unlocked?"bg-gradient-to-br "+a.color+" text-white border-transparent shadow-lg":"bg-gray-100 border-gray-200 opacity-50"}`,children:[e.jsx(l,{className:`w-12 h-12 mx-auto mb-2 ${a.unlocked?"":"text-gray-400"}`}),e.jsx("h4",{className:"font-bold text-sm mb-1",children:a.name}),e.jsx("p",{className:`text-xs ${a.unlocked?"text-white/90":"text-gray-500"}`,children:a.description})]},a.id)})})})]})}function ge({progress:s}){const a=s.slice(0,10).reverse().map((l,i)=>({name:`Game ${i+1}`,score:l.score,accuracy:Math.round(l.correct_answers/l.total_questions*100)}));return e.jsxs(c,{className:"mb-8",children:[e.jsx(h,{children:e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-6 h-6 text-green-500"}),"Performance Over Time"]})}),e.jsx(o,{children:a.length>0?e.jsx(re,{width:"100%",height:300,children:e.jsxs(le,{data:a,children:[e.jsx(ne,{strokeDasharray:"3 3"}),e.jsx(ie,{dataKey:"name"}),e.jsx(ce,{}),e.jsx(oe,{}),e.jsx(de,{}),e.jsx(E,{type:"monotone",dataKey:"score",stroke:"#8b5cf6",strokeWidth:3}),e.jsx(E,{type:"monotone",dataKey:"accuracy",stroke:"#10b981",strokeWidth:3})]})}):e.jsx("div",{className:"text-center py-12 text-gray-500",children:"Play some games to see your performance chart!"})})]})}function pe({progress:s}){const m=s.slice(0,10),a={addition:"âž•",subtraction:"âž–",multiplication:"âœ–ï¸",division:"âž—"},l={easy:"bg-green-500",medium:"bg-yellow-500",hard:"bg-red-500"};return e.jsxs(c,{children:[e.jsx(h,{children:e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(w,{className:"w-6 h-6 text-blue-500"}),"Recent Games"]})}),e.jsx(o,{children:e.jsx("div",{className:"space-y-3",children:m.map((i,n)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl border border-purple-100 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-3xl",children:a[i.operation]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-bold capitalize",children:i.operation}),e.jsx(F,{className:l[i.level]+" text-white",children:i.level})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(v,{className:"w-4 h-4"}),i.correct_answers,"/",i.total_questions]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(w,{className:"w-4 h-4"}),i.time_taken,"s"]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"flex gap-1 mb-1",children:[1,2,3].map(p=>e.jsx(u,{className:`w-5 h-5 ${p<=i.stars_earned?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},p))}),e.jsx("div",{className:"text-sm text-gray-500",children:Q(new Date(i.created_date),"MMM d, h:mm a")})]})]},n))})})]})}function Ce(){const{user:s}=Y(),[m,a]=q.useState([]),{data:l=[],isLoading:i}=N({queryKey:["gameProgress",s==null?void 0:s.email],queryFn:async()=>s!=null&&s.email?await J(s.email):[],initialData:[],enabled:!!(s!=null&&s.email),onSuccess:t=>{m.length||a(t)}});q.useEffect(()=>{if(!(s!=null&&s.email))return;const t=V(s.email,r=>{a(r)});return()=>t()},[s==null?void 0:s.email]);const n=m.length?m:l,{data:p=[]}=N({queryKey:["userDailyChallenges",s==null?void 0:s.email],queryFn:async()=>s!=null&&s.email?await ee(s.email):[],initialData:[],enabled:!!(s!=null&&s.email)}),{data:j=[]}=N({queryKey:["tutorSessions",s==null?void 0:s.email],queryFn:async()=>s!=null&&s.email?await se(s.email):[],initialData:[],enabled:!!(s!=null&&s.email)}),k=()=>n.reduce((t,r)=>t+(r.stars_earned||0),0),R=()=>p.reduce((t,r)=>t+(r.bonus_stars||0),0),U=()=>n.reduce((t,r)=>t+(r.score||0),0),L=()=>{if(n.length===0)return 0;const t=n.reduce((r,d)=>r+d.correct_answers/d.total_questions*100,0);return Math.round(t/n.length)},H=()=>n.reduce((t,r)=>t+(r.time_taken||0),0),C=()=>n.length,f=k()+R(),K=f-((s==null?void 0:s.stars_spent)||0),S=(()=>{const t=C(),r=n.some(g=>g.stars_earned===3),d=n.some(g=>g.correct_answers/g.total_questions===1),$=n.some(g=>g.level==="hard"&&g.stars_earned>=2),B=p.length,x=[];return t>=5&&x.push({name:"Curly Hair",emoji:"ðŸ¦±"}),t>=7&&x.push({name:"Hat",emoji:"ðŸŽ©"}),t>=10&&x.push({name:"Sporty Outfit",emoji:"âš½"}),f>=10&&x.push({name:"Spiky Hair",emoji:"âš¡"}),r&&x.push({name:"Cool Eyes",emoji:"ðŸ˜Ž"}),d&&x.push({name:"Heart Eyes & Pirate Outfit",emoji:"ðŸ˜ðŸ´â€â˜ ï¸"}),$&&x.push({name:"Purple Hair, Superhero Outfit & Cape",emoji:"ðŸ¦¸"}),B>=7&&x.push({name:"Artist Outfit",emoji:"ðŸŽ¨"}),x.slice(0,3)})(),O=xe({queryKey:["gameProgress",s==null?void 0:s.email]})>0,_=(()=>{const t={};return j.forEach(r=>{const d=`${r.operation}-${r.level}`;t[d]||(t[d]={operation:r.operation,level:r.level,count:0}),t[d].count++}),Object.values(t).sort((r,d)=>d.count-r.count).slice(0,3)})();return i?e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-16 h-16 border-4 border-purple-500 border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Loading your progress..."})]})}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[O&&e.jsx("div",{className:"fixed top-20 right-4 z-40",children:e.jsxs("div",{className:"flex items-center gap-2 bg-white/90 backdrop-blur px-3 py-2 rounded-full shadow border",children:[e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-purple-500 border-t-transparent rounded-full"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Updatingâ€¦"})]})}),e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("div",{className:"inline-block mb-6",children:e.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full flex items-center justify-center shadow-2xl",children:e.jsx(y,{className:"w-12 h-12 text-white"})})}),e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-4 bg-gradient-to-r from-purple-600 via-pink-600 to-blue-600 bg-clip-text text-transparent",children:"Your Progress"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Keep up the great work! ðŸŽ‰"})]}),n.length===0?e.jsx(c,{className:"text-center py-12",children:e.jsxs(o,{children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(W,{size:"lg",variant:"circle"})}),e.jsx("h3",{className:"text-2xl font-bold mb-2",children:"No games played yet!"}),e.jsx("p",{className:"text-gray-600",children:"Start playing to see your progress here."})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-8",children:[e.jsx(c,{className:"md:col-span-2 border-4 border-yellow-300 shadow-xl bg-gradient-to-r from-yellow-50 to-orange-50",children:e.jsx(o,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full flex items-center justify-center shadow-lg",children:e.jsx(u,{className:"w-8 h-8 text-white fill-white"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-3xl font-bold text-gray-800",children:[K," Stars Available"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[f," total earned â€¢ ",(s==null?void 0:s.stars_spent)||0," spent"]})]})]}),e.jsx(G,{to:M("Shop"),children:e.jsxs(A,{className:"h-12 bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600",children:[e.jsx(X,{className:"w-5 h-5 mr-2"}),"Visit Shop"]})})]})})}),S.length>0&&e.jsx(c,{className:"border-4 border-green-300 shadow-xl bg-gradient-to-r from-green-50 to-emerald-50",children:e.jsxs(o,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(me,{className:"w-6 h-6 text-green-600"}),e.jsx("h3",{className:"font-bold text-lg text-green-800",children:"New Rewards!"})]}),e.jsx("div",{className:"space-y-2 mb-3",children:S.map((t,r)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-xl",children:t.emoji}),e.jsx("span",{className:"font-medium",children:t.name})]},r))}),e.jsx(G,{to:M("Shop"),children:e.jsx(A,{variant:"outline",className:"w-full border-green-400 text-green-700 hover:bg-green-100",children:"Claim Rewards"})})]})})]}),j.length>0&&e.jsxs(c,{className:"mb-8 border-4 border-blue-300 shadow-xl bg-gradient-to-r from-blue-50 to-purple-50",children:[e.jsx(h,{className:"bg-gradient-to-r from-blue-100 to-purple-100 p-6 rounded-t-xl",children:e.jsxs(b,{className:"flex items-center gap-2 text-xl font-bold text-blue-800",children:[e.jsx(Z,{className:"w-7 h-7 text-blue-600"}),"AI Tutor Learning Insights"]})}),e.jsxs(o,{className:"p-6",children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-xl text-center border-2 border-blue-200 shadow-sm",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:j.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Tutoring Sessions"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl text-center border-2 border-purple-200 shadow-sm",children:[e.jsx("div",{className:"text-3xl font-bold text-purple-600",children:j.filter(t=>t.hint_requested).length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Hints Received"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl text-center border-2 border-green-200 shadow-sm",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:j.filter(t=>t.explanation_viewed).length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Explanations Viewed"})]})]}),_.length>0&&e.jsxs("div",{className:"bg-white p-4 rounded-xl border-2 border-orange-200 shadow-sm",children:[e.jsxs("h4",{className:"font-bold mb-3 flex items-center gap-2 text-lg text-orange-700",children:[e.jsx(v,{className:"w-5 h-5 text-orange-600"}),"Practice These Topics"]}),e.jsx("div",{className:"space-y-2",children:_.map((t,r)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"capitalize font-medium text-gray-700",children:[t.operation," (",t.level,")"]}),e.jsxs(F,{variant:"outline",className:"bg-orange-50 text-orange-600 border-orange-200",children:[t.count," times needed help"]})]},r))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-8",children:[e.jsxs(c,{className:"bg-gradient-to-br from-yellow-400 to-orange-500 text-white border-0",children:[e.jsx(h,{className:"pb-2",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsx(u,{className:"w-8 h-8 fill-white"})})}),e.jsxs(o,{children:[e.jsx("div",{className:"text-3xl font-bold mb-1",children:k()}),e.jsx("p",{className:"text-sm text-white/90",children:"Game Stars"})]})]}),e.jsxs(c,{className:"bg-gradient-to-br from-purple-500 to-pink-500 text-white border-0",children:[e.jsx(h,{className:"pb-2",children:e.jsx(y,{className:"w-8 h-8"})}),e.jsxs(o,{children:[e.jsx("div",{className:"text-3xl font-bold mb-1",children:U()}),e.jsx("p",{className:"text-sm text-white/90",children:"Total Score"})]})]}),e.jsxs(c,{className:"bg-gradient-to-br from-green-500 to-emerald-500 text-white border-0",children:[e.jsx(h,{className:"pb-2",children:e.jsx(v,{className:"w-8 h-8"})}),e.jsxs(o,{children:[e.jsxs("div",{className:"text-3xl font-bold mb-1",children:[L(),"%"]}),e.jsx("p",{className:"text-sm text-white/90",children:"Accuracy"})]})]}),e.jsxs(c,{className:"bg-gradient-to-br from-blue-500 to-cyan-500 text-white border-0",children:[e.jsx(h,{className:"pb-2",children:e.jsx(w,{className:"w-8 h-8"})}),e.jsxs(o,{children:[e.jsxs("div",{className:"text-3xl font-bold mb-1",children:[Math.floor(H()/60),"m"]}),e.jsx("p",{className:"text-sm text-white/90",children:"Time Played"})]})]}),e.jsxs(c,{className:"bg-gradient-to-br from-indigo-500 to-purple-500 text-white border-0",children:[e.jsx(h,{className:"pb-2",children:e.jsx(D,{className:"w-8 h-8"})}),e.jsxs(o,{children:[e.jsx("div",{className:"text-3xl font-bold mb-1",children:C()}),e.jsx("p",{className:"text-sm text-white/90",children:"Games Played"})]})]})]}),e.jsx(he,{progress:n}),e.jsx(ge,{progress:n}),e.jsx(pe,{progress:n})]})]})}export{Ce as default};
