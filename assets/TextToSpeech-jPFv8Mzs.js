import{r as x,j as v}from"./index-C0XnwW1J.js";let i={},C=null;function k(b="en-US",y=!0,p={}){const{useSavedPrefs:c=!0,langPrefOverride:d,voiceNameOverride:m}=p;try{const e=localStorage.getItem("tts.cacheBuster");c&&e&&e!==C&&(i={},C=e)}catch{}const n=window.speechSynthesis.getVoices();let r="en",l="Emma";try{if(c){r=localStorage.getItem("tts.lang")==="es"?"es":"en";const e=localStorage.getItem("tts.voiceName");l=e&&e.toLowerCase()!=="david"?e:"Emma"}else r=d==="es"?"es":"en",l=m||"Emma"}catch{}const a=`${c?"saved":"override"}:${r}:${l}`;if(i[a])return i[a];if(n&&n.length){let e=n.filter(o=>(o.lang||"").toLowerCase().startsWith(r));const g=l.toLowerCase();let t=e.find(o=>o.name.toLowerCase().includes(g));if(t)return i[a]=t,t;const s=["emma","female","woman","girl","zira","jenny","olivia","sonia","ana","isabella","sara","sofia","monica","paulina"];if(t=e.find(o=>s.some(h=>o.name.toLowerCase().includes(h))),t)return i[a]=t,t;const S=["david","male","man","boy","mark","james","richard","thomas","daniel","george"],f=e.filter(o=>!S.some(h=>o.name.toLowerCase().includes(h)));if(f.length>0)return i[a]=f[0],f[0];const w=n.filter(o=>s.some(h=>o.name.toLowerCase().includes(h)));if(w.length>0)return i[a]=w[0],w[0]}return n.find(e=>e.default)||n[0]}function L({text:b,lang:y="en-US",style:p="button",label:c="ðŸ”Š Listen",rate:d=.9,useSavedPrefs:m=!0,overrideLangPref:n,overrideVoiceName:r}){const l=x.useRef(null),u=()=>{if(!("speechSynthesis"in window)){alert("Text-to-speech is not supported in this browser.");return}window.speechSynthesis.cancel();const g=window.speechSynthesis.getVoices();if(!g||g.length===0){window.speechSynthesis.getVoices(),setTimeout(()=>u(),100);return}const t=new window.SpeechSynthesisUtterance(b);try{const s=m?localStorage.getItem("tts.lang")==="es"?"es":"en":n==="es"?"es":"en";t.lang=s==="es"?"es-ES":"en-US"}catch{t.lang=y}try{const s=m?parseFloat(localStorage.getItem("tts.rate")):d;t.pitch=1,t.rate=Number.isNaN(s)?d:Math.min(2,Math.max(.1,s))}catch{t.pitch=1,t.rate=Math.min(2,Math.max(.1,d))}t.voice=k(t.lang,!0,{useSavedPrefs:m,langPrefOverride:n,voiceNameOverride:r||"Emma"}),l.current=t,window.speechSynthesis.speak(t)},a=()=>{window.speechSynthesis.cancel()};let e;return p==="badge"?e=v.jsx("span",{onClick:u,onDoubleClick:a,className:"inline-block px-2 py-1 bg-purple-100 text-purple-700 rounded cursor-pointer select-none",title:"Click to read aloud, double-click to stop",children:c}):p==="icon"?e=v.jsx("span",{onClick:u,onDoubleClick:a,className:"cursor-pointer",title:"Click to read aloud, double-click to stop",role:"img","aria-label":"Read aloud",children:"ðŸ”Š"}):e=v.jsx("button",{type:"button",onClick:u,onDoubleClick:a,"aria-label":"Read aloud",className:"px-3 py-2 rounded bg-purple-100 hover:bg-purple-200 text-purple-700 font-semibold",children:c}),e}export{L as T};
